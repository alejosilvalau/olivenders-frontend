<div class="container-fluid mb-4">
  <button class="btn d-lg-none mt-2 w-100 filter-button" (click)="toggleFilter()">
    {{ showFilter ? "Hide Filters" : "Show Filters" }}
  </button>

  <div class="row">
    <div
      class="col-12 col-lg-3 filter"
      [class.d-none]="!showFilter && isMobile"
    >
      <app-filter
        (filterChanged)="onFilterChanged($event)"
        class="sticky-lg-top"
      ></app-filter>
    </div>

    <div class="col-12 col-lg-9 mt-5">
      <div class="row g-3">
        <app-infinite-scroll (scrolled)="onScrollLoadMore()" [disabled]="loading">
          <div
            *ngFor="let wand of filteredWands"
            class="col-12 col-sm-6 col-md-4 col-xl-3"
          >
            <div class="card h-100">
              <div class="position-relative">
                <img
                  id="wand-image"
                  class="card-img-top img-fluid"
                  [src]="wand.image"
                  alt="wand-image"
                />
                <h5 class="card-title text-center mt-2 fw-normal">
                  {{ wand.name | titlecase }}
                </h5>
                <app-wand-details-button
                  [wand]="wand"
                ></app-wand-details-button>
              </div>
              <div class="card-body d-flex flex-column">
                <div class="mt-auto custom-button-container flex flex-column">
                  <p
                    *ngIf="wand.total_price > 0 && wand.total_price !== null"
                    class="card-text price-product mb-2"
                  >
                    <strong class="ms-2">Price:</strong> {{ wand.total_price | currency}}
                  </p>
                  <a
                    [routerLink]="['/product/order', wand.id]"
                    [state]="{ wand: wand }"
                    class="btn w-50 mx-1 mb-2 w-100 custom-buy-button"
                    [class.disabled]="isWandAvailable(wand)"
                  >
                    Buy
                  </a>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="loading" class="text-center py-3">
            <span class="spinner-border"></span>
          </div>
          <p
            *ngIf="filteredWands.length === 0 && !loading"
            class="no-wands-message"
          >
            No wands found with the selected filters
          </p>
        </app-infinite-scroll>
      </div>
    </div>
  </div>
</div>
